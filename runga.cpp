#include "automaton.h"

//to improve on genomes generated in previous runs, put them in here and use
//this initializer. If you have none, you can use the default initializer or
//this with an empty prevWinners.
static void addPrevWinners(GAPopulation& gp) {
	gp.DefaultInitializer(gp);

	vector<string> prevWinners(0);
	//push back whatever genomes you want to start with
	prevWinners.push_back("00010100000101100010110101110011000011011010000101010110100000100111101111101111110111110100101001110110110110010100001000101001011011111000011001101101101010110100101101000111100101101000110000000110011110001011110001101111011110010001111001011110100010110001110000110110000110011000010001000100111100010110010111001100000101101111010011010101001101000001111000010101001101000011111000010011100011110000100001111000000010011011001111110011100000110011100110001001000011101101111111110100111110010010100110010111");
	prevWinners.push_back("00010100000101000010110101110011000011001010000101010110100001100111101111101111110111110100101001110110110110010100001000101001011011111000011001101001101010110100101101000111100101111000111000010111011110001011110001101111011110010000111001011110100010100001110100110010000111011000010001000100101100010100010111011100000001101111110011001101001101010001101100010011101101000011111101000011100011110100000001101000010010101011001101101011010101111011110011111110010010111011110111111101011110010001100111011000");
	prevWinners.push_back("00010000000101100010110101100011000011011111000101010010000000100011101110101111110111110100101001000110110110010101011001101001011011111000011001001101110010110110101100000111100101001000110000100110011100001011110001101111011110010001110001011110110010110001110000110110000110111000010001000010111100010110010111000101000111001011010011001101101100010001110100010111001100001011111000110011111111110000000011010000011010001011101111110111100000110011100110001011010111111101101101111001100100110111111001111111");
	prevWinners.push_back("00000100001101010010110101110011000011001010000101010110100011100111101101101011110111110100001001110110110010001001000100110011011010101000111111011101111110110111110101101000110101011011010101010100001000000001100001101011100110100010101101100000110001100010001001100000001101010100100110011000100111101011001100111011000110110010111111100001110011100101101001001010100001000111111000100000100100100110000111101001010001111011010001100100101110000000110010010001010011111111010100011000110110010100011111010001");
	prevWinners.push_back("00010001000101000010110101100011001011001010000101010111100001100111100111101111111111110100101101110110110110010000001001100001011011111000011001101001101010110100101101000111100101111000111100010101011110001011110001101111011110010000111000011110101010100001110100110010000111011000010001000100101100010100010111011100000001101111110011001111001101110001101110010011001101100011111101000011100011110100000001101000010010101111000101101001010101111011110011111110010010111011110111111101111110010001100101011001");

	for (unsigned i=0; i<prevWinners.size(); i++)
		gp.replace( strToGenome(prevWinners[i]) );// , -2 );

}

int main( int argc , char *argv[] ) {
	if (argc != 2)
		cerr << "Give arguments pls" << endl;

	//create a blank genome
	GA1DBinaryStringGenome genome(GENOME_LENGTH,fitnessFunction);

	//and a GA instance on a population of that genome
	//plus the previous winners
	GAPopulation gp(genome,50);
	gp.initializer(addPrevWinners);

	GASimpleGA ga(gp);
	ga.population(gp);
/*
	int popsize  = 30;
	int ngen     = 400;
	float pmut   = 0.001;
	float pcross = 0.9;


	ga.populationSize(popsize);
	ga.nGenerations(ngen);
	ga.pMutation(pmut);
	ga.pCrossover(pcross);
*/

	//set parameters
	ga.scoreFilename(argv[1]);
	ga.flushFrequency(100);
	ga.nBestGenomes(5);
	ga.nGenerations(4000);
	ga.pMutation(0.05);

	ga.initialize();

	cout<<"--- BEFORE ---"<<endl;
	cout << ga.statistics() << endl;
	cout<<"best 5 genomes: "<<endl;
	cout<< ga.statistics().bestPopulation() << endl;

	ga.evolve();

	cout<<"--- AFTER ---"<<endl;
	cout << ga.statistics() << endl;
	cout<<"best 5 genomes: "<<endl;
	cout<< ga.statistics().bestPopulation() << endl;
	return 0;
}